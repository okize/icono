// Generated by CoffeeScript 1.6.3
var Q, fs, mime, svgo, _;

fs = require('fs');

mime = require('mime');

_ = require('underscore');

Q = require('q');

svgo = new (require('svgo'))();

exports.encodeImage = function(data, type, format) {
  var encoded, formatMap;
  formatMap = {
    'svg': '\'data:image/svg+xml;base64,',
    'png': '\'data:image/png;base64,'
  };
  encoded = new Buffer(data).toString(type);
  return formatMap[format] + encoded + '\'';
};

exports.roundNum = function(num) {
  return Math.round(num).toString();
};

exports.trimExt = function(filename) {
  return filename.replace(/\.[^/.]+$/, '');
};

exports.filterNonSvgFiles = function(files) {
  return _.filter(files, function(file) {
    return mime.lookup(file) === 'image/svg+xml';
  });
};

exports.optimizeSvg = function(data) {
  var d;
  d = Q.defer();
  svgo.optimize(data, function(result) {
    if (result.error) {
      d.reject(new Error(result.error));
    }
    return d.resolve(result);
  });
  return d.promise;
};
